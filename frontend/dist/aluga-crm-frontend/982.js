"use strict";(self.webpackChunkaluga_crm_frontend=self.webpackChunkaluga_crm_frontend||[]).push([[982],{7982:(y,n,s)=>{s.r(n),s.d(n,{DASHBOARD_ROUTES:()=>d});var t=s(4438),l=s(177),u=s(7468),C=s(6354),g=s(6344);let D=(()=>{class r{constructor(){this.api=(0,t.WQX)(g.G)}loadSummary(){return(0,u.p)({imoveis:this.api.get("/imoveis?size=1&page=0"),contratos:this.api.get("/contratos?status=ATIVO"),receitas:this.api.get("/financeiro?tipo=RECEITA&periodo=mensal"),despesas:this.api.get("/financeiro?tipo=DESPESA&periodo=mensal")}).pipe((0,C.T)(({imoveis:o,contratos:e,receitas:a,despesas:i})=>({totalImoveis:o?.total??0,contratosAtivos:e?.totalAtivos??0,totalReceitasMes:a?.total??0,totalDespesasMes:i?.total??0})))}loadChartData(){return this.api.get("/financeiro?groupBy=mes")}static{this.\u0275fac=function(e){return new(e||r)}}static{this.\u0275prov=t.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var v=s(5567),c=s(9683);const d=[{path:"",component:(()=>{class r{constructor(){this.dashboardService=(0,t.WQX)(D),this.notification=(0,t.WQX)(v.J),this.summary=(0,t.vPA)({totalImoveis:0,contratosAtivos:0,totalReceitasMes:0,totalDespesasMes:0}),this.lineChartData={labels:[],datasets:[{label:"Receitas",data:[],borderColor:"#2ea043",backgroundColor:"rgba(46, 160, 67, 0.2)",tension:.4,fill:!0},{label:"Despesas",data:[],borderColor:"#f85149",backgroundColor:"rgba(248, 81, 73, 0.2)",tension:.4,fill:!0}]},this.lineChartOptions={responsive:!0,plugins:{legend:{labels:{color:"#c9d1d9"}}},scales:{x:{ticks:{color:"#8b949e"},grid:{color:"#21262d"}},y:{ticks:{color:"#8b949e"},grid:{color:"#21262d"}}}},this.pieChartData={labels:[],datasets:[{data:[],backgroundColor:["#1f6feb","#2ea043","#f85149","#a371f7","#d29922"]}]},this.pieChartOptions={responsive:!0,plugins:{legend:{position:"bottom",labels:{color:"#c9d1d9"}}}},this.barChartData={labels:[],datasets:[{label:"Receitas",data:[],backgroundColor:"#2ea043"},{label:"Despesas",data:[],backgroundColor:"#f85149"}]},this.barChartOptions={responsive:!0,plugins:{legend:{labels:{color:"#c9d1d9"}}},scales:{x:{ticks:{color:"#8b949e"},grid:{display:!1}},y:{ticks:{color:"#8b949e"},grid:{color:"#21262d"}}}}}ngOnInit(){this.loadSummary(),this.loadCharts()}loadSummary(){this.dashboardService.loadSummary().subscribe({next:o=>this.summary.set(o),error:()=>this.notification.error("Nao foi possivel carregar os indicadores.")})}loadCharts(){this.dashboardService.loadChartData().subscribe({next:o=>{const e=o?.labels??[],a=o?.receitas??[],i=o?.despesas??[],h=o?.categorias??[],p=o?.valoresCategoria??[];this.lineChartData={...this.lineChartData,labels:e,datasets:[{...this.lineChartData.datasets[0],data:a},{...this.lineChartData.datasets[1],data:i}]},this.barChartData={...this.barChartData,labels:e,datasets:[{...this.barChartData.datasets[0],data:a},{...this.barChartData.datasets[1],data:i}]},this.pieChartData={...this.pieChartData,labels:h,datasets:[{...this.pieChartData.datasets[0],data:p}]}},error:()=>this.notification.warning("Nao foi possivel montar os graficos.")})}static{this.\u0275fac=function(e){return new(e||r)}}static{this.\u0275cmp=t.VBU({type:r,selectors:[["app-dashboard"]],standalone:!0,features:[t.aNF],decls:37,vars:23,consts:[[1,"space-y-6"],[1,"grid","gap-4","md:grid-cols-4"],[1,"card"],[1,"text-sm","text-gray-400"],[1,"text-2xl","font-semibold","text-primary","mt-2"],[1,"text-2xl","font-semibold","text-emerald-400","mt-2"],[1,"text-2xl","font-semibold","text-rose-400","mt-2"],[1,"grid","gap-4","lg:grid-cols-2"],[1,"text-lg","font-semibold","mb-4"],["baseChart","",3,"data","options","type"]],template:function(e,a){1&e&&(t.j41(0,"div",0)(1,"section",1)(2,"article",2)(3,"h3",3),t.EFF(4,"Total de imoveis"),t.k0s(),t.j41(5,"p",4),t.EFF(6),t.k0s()(),t.j41(7,"article",2)(8,"h3",3),t.EFF(9,"Contratos ativos"),t.k0s(),t.j41(10,"p",4),t.EFF(11),t.k0s()(),t.j41(12,"article",2)(13,"h3",3),t.EFF(14,"Receitas no mAas"),t.k0s(),t.j41(15,"p",5),t.EFF(16),t.nI1(17,"currency"),t.k0s()(),t.j41(18,"article",2)(19,"h3",3),t.EFF(20,"Despesas no mAas"),t.k0s(),t.j41(21,"p",6),t.EFF(22),t.nI1(23,"currency"),t.k0s()()(),t.j41(24,"section",7)(25,"article",2)(26,"h3",8),t.EFF(27,"Fluxo de caixa"),t.k0s(),t.nrm(28,"canvas",9),t.k0s(),t.j41(29,"article",2)(30,"h3",8),t.EFF(31,"Composicao de despesas"),t.k0s(),t.nrm(32,"canvas",9),t.k0s()(),t.j41(33,"section",2)(34,"h3",8),t.EFF(35,"Receitas x Despesas"),t.k0s(),t.nrm(36,"canvas",9),t.k0s()()),2&e&&(t.R7$(6),t.JRh(a.summary().totalImoveis),t.R7$(5),t.JRh(a.summary().contratosAtivos),t.R7$(5),t.SpI(" ",t.ii3(17,13,a.summary().totalReceitasMes,"BRL","symbol","1.0-2")," "),t.R7$(6),t.SpI(" ",t.ii3(23,18,a.summary().totalDespesasMes,"BRL","symbol","1.0-2")," "),t.R7$(6),t.Y8G("data",a.lineChartData)("options",a.lineChartOptions)("type","line"),t.R7$(4),t.Y8G("data",a.pieChartData)("options",a.pieChartOptions)("type","pie"),t.R7$(4),t.Y8G("data",a.barChartData)("options",a.barChartOptions)("type","bar"))},dependencies:[l.MD,l.oe,c.FR,c.j9],encapsulation:2})}}return r})()}]},7468:(y,n,s)=>{s.d(n,{p:()=>c});var t=s(1985),l=s(3073),u=s(8750),C=s(3794),g=s(4360),D=s(6450),v=s(8496);function c(...b){const d=(0,C.ms)(b),{args:r,keys:E}=(0,l.D)(b),o=new t.c(e=>{const{length:a}=r;if(!a)return void e.complete();const i=new Array(a);let h=a,p=a;for(let m=0;m<a;m++){let f=!1;(0,u.Tg)(r[m]).subscribe((0,g._)(e,O=>{f||(f=!0,p--),i[m]=O},()=>h--,void 0,()=>{(!h||!f)&&(p||e.next(E?(0,v.e)(E,i):i),e.complete())}))}});return d?o.pipe((0,D.I)(d)):o}}}]);